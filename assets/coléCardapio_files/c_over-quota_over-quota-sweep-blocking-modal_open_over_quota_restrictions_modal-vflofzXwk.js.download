!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="86501452-1efe-3938-8d79-7035e04378e0")}catch(e){}}();
define(["require","exports","react","./e_file_viewer_static_scl_page_file","./e_data_modules_stormcrow","./c_over-quota_utils_use_get_plans","./c_core_i18n","./c_growth-components_over-quota-file-viewer-modal","./c_over-quota_utils_oq_price_decrease_helper","./e_edison","./c_bem","./c_chat_chat_constants","./c_spectrum_util_raf_throttle","./e_core_exception","./c_init_data_edison","./c_dotlottie_common_chunk-B7OIQIGJ","./c_src_sink_index","./c_lodash-es_lodash","./c_react-use_misc_util","./c_api_v2_routes_restorations_provider","./c_api_v2_unauthed_client","./c_hive_schemas_sharing-request_access_user_events","./c_core_notify","react-dom","./c_api_v2_routes_team_insights_provider","./c_security_csrf_hmac","./c_react-use_useEffectOnce","./c_pap-events_navigation_select_create_folder_action","react/jsx-runtime","./c_trial-plan-card_components_header","./c_dig-components_combinations_index","./c_dig-icons_assets_ui-icon_line_tag","./c_trial-cards_trial-plan-card","./c_dig-components_meter_index","./c_react-hookz_web_useRafCallback","metaserver/static/js/langpack","./c_custom_campaigns_out_of_space_modal_out_of_space_checkout_modal_logger"],(function(e,t,o,a,n,i,l,r,_,s,c,d,u,m,f,p,v,w,g,C,y,h,S,M,E,b,O,P,x,k,L,I,T,q,B,N,R){"use strict";function A(e){return e&&e.__esModule?e:{default:e}}var D=A(o);a.injectInternalStyle("/static/js/growth-components/auto-layout-modal/index.module.out-vflZGSA-h.css",(e=>"._bannerSection_5w59f_1{margin-bottom:var(--dig-spacing__macro__small);margin-top:var(--dig-spacing__micro__small)}._sideBySideContentContainer_5w59f_6{align-items:stretch;column-gap:var(--dig-spacing__macro__small);display:flex;flex-direction:row}._sideBySideContentItem_5w59f_13{flex:1}._footer_5w59f_17{display:flex;flex-wrap:wrap-reverse;gap:var(--dig-spacing__dimension__8)}._footerSplit_5w59f_23{justify-content:space-between}._autoLayoutModalMobile_5w59f_27{._bannerSection_5w59f_1{margin:var(--dig-spacing__micro__large) calc(var(--dig-spacing__macro__small)*-1)}._sideBySideContentContainer_5w59f_6{align-items:stretch;flex-direction:column;margin-top:var(--dig-spacing__macro__xsmall);row-gap:var(--dig-spacing__macro__small)}._sideBySideContentItem_5w59f_13{flex-grow:0}}._autoLayoutModalMobile_5w59f_27._mobileCentered_5w59f_47{._sideBySideContentContainer_5w59f_6{display:block}._title_5w59f_52{text-align:center}._sideBySideContentItem_5w59f_13{align-items:center;display:flex;justify-content:center}._secondSideBySideContentItem_5w59f_62{margin-top:var(--dig-spacing__dimension__24)}._footer_5w59f_17{align-items:center;flex-direction:column-reverse}._footerButton_5w59f_71{margin:auto}}._expandableModal_5w59f_76{width:fit-content!important}"));const U="_bannerSection_5w59f_1",V="_sideBySideContentContainer_5w59f_6",Q="_sideBySideContentItem_5w59f_13",W="_footer_5w59f_17",F="_footerSplit_5w59f_23",G="_autoLayoutModalMobile_5w59f_27",H="_mobileCentered_5w59f_47",j="_title_5w59f_52",z="_secondSideBySideContentItem_5w59f_62",K="_expandableModal_5w59f_76",$=({title:e,bannerOptions:t,firstChild:o,secondChild:n,primaryCtaText:i,primaryCtaOnClick:l,primaryCtaProps:r,secondaryCtaText:_,secondaryCtaOnClick:s,secondaryCtaProps:c,showCloseButton:d,onCloseButtonClick:u,width:m=600,centerMobileView:f=!1,minWidth:p=366,maxWidth:v,isPrimaryCtaLoading:w=!1,footerCtaLayout:g="grouped"})=>{const[C,y]=D.default.useState(window.innerWidth<=m);D.default.useLayoutEffect((()=>{function e(){y(window.innerWidth<=m)}return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[m]);const h=t&&D.default.createElement(a.Box,{className:U},D.default.createElement(a.Banner,{type:t.type,borderRadius:C?"None":"Large"},D.default.createElement(a.Banner.Message,null,t.text),t.ctaText&&D.default.createElement(a.Banner.Actions,null,D.default.createElement(a.Button,{variant:"transparent",onClick:t.ctaOnClick},t.ctaText)))),S=a.cx({[G]:C,[H]:C&&f,[K]:void 0!==v&&!C});return D.default.createElement(a.Modal,{open:!0,withCloseButton:d?"Close":void 0,onRequestClose:e=>null==u?void 0:u(e),width:m,className:S,fullScreen:C,contentStyles:C?void 0:{minWidth:`${p}px`,maxWidth:v?`${v}px`:void 0}},D.default.createElement(a.Modal.Header,null,C&&h,D.default.createElement(a.Modal.Title,{className:j},e)),D.default.createElement(a.Modal.Body,null,!C&&h,D.default.createElement(a.Box,{className:V},D.default.createElement(a.Box,{className:Q},o),n&&D.default.createElement(a.Box,{className:a.cx(Q,z)},n))),D.default.createElement(a.Modal.Footer,{className:a.cx(W,{[F]:"split"===g})},_&&D.default.createElement(a.Button,{variant:"opacity",onClick:s,...c},_),D.default.createElement(a.Button,{variant:"primary",onClick:l,isLoading:w,...r},i)))};$.displayName="AutoLayoutModal";const J="OVER_QUOTA_RESTRICTIONS_MODAL",X=({action:t,continueCallback:n,abortCallback:s,filePreview:c,fileName:d,downloadFileHandler:u})=>{var m,f,p,v,w,g,C,y,h,S;const[M,E]=D.default.useState(!1),{user:b}=a.useActiveUser(),{quotaUpsellInfo:O,isLoadingQuotaUpsellInfo:P}=a.useQuotaUpsellInfo(b),{shouldUseSmallSkus:x}=_.useOverquotaPriceDecrease(b),{plansInfo:k,isLoadingPlansInfo:L}=i.useGetPlans({planNames:["basic","plus"],revenueContentLocation:"oq_restrictions_modal"}),{plansInfo:I,isLoadingPlansInfo:T}=i.useGetPlans({planNames:["basic","basic500"],revenueContentLocation:"oq_smaller_skus_modal"}),q=x?I:k,B=x?T:L,N=o.useRef(!1),R="ON"===a.useExperimentVariant("overquota_glide_modal").variant,A=(null===(m=null==O?void 0:O.quota)||void 0===m?void 0:m.used)||0,U=i.getViewMode(t),[V,Q]=D.default.useState(window.innerWidth<=i.OVER_QUOTA_RESTRICTIONS_MODAL_MIN_WIDTH_DESKTOP);D.default.useLayoutEffect((()=>{function e(){Q(window.innerWidth<=i.OVER_QUOTA_RESTRICTIONS_MODAL_MIN_WIDTH_DESKTOP)}return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]);const W=(null===(v=null===(p=null===(f=null==O?void 0:O.quota)||void 0===f?void 0:f.allocation)||void 0===p?void 0:p.individual)||void 0===v?void 0:v.allocated)||0,F=U!==i.ViewMode.UploadOrCreate&&((null===(w=null==O?void 0:O.restrictions)||void 0===w?void 0:w.show_restrictions_warning)||!1),G=void 0!==(null===(g=null==O?void 0:O.quota)||void 0===g?void 0:g.used)&&void 0!==(null===(C=null==k?void 0:k.PLUS)||void 0===C?void 0:C.quota_bytes)&&O.quota.used<k.PLUS.quota_bytes,H=a.getOverQuotaReason(null==O?void 0:O.overquota_reason),j=null!==(y=_.getOrganicOrChurnedFromString(H))&&void 0!==y?y:"unlabeled",z=null===(h=null==O?void 0:O.restrictions)||void 0===h?void 0:h.overquota_start_time_utc_seconds,K=z?Date.now()/1e3-z:void 0,X=(null===(S=null==O?void 0:O.restrictions)||void 0===S?void 0:S.show_restrictions_warning)&&!!z&&0!==z,Y=x?"dropbox500":q&&G?"plus":"none",Z=o.useMemo((()=>({overQuotaSweepBlockingModalAction:t,quotaLimit:W,quotaUsed:A,organicOrChurned:j,secondsOverquota:K,hardblocked:!F,planShown:Y,restrictionsStartDateShown:X})),[W,A,j,K,F,t,q,G,X]);if(o.useEffect((()=>{B||P||N.current||(_.logShownOverquotaRestrictionsModal(Z),N.current=!0)}),[Z,B,P]),o.useEffect((()=>{B||P||N.current||(new Promise((function(t,o){e(["./c_custom_campaigns_out_of_space_modal_out_of_space_modal_doorman_wrapper"],t,o)})),new Promise((function(t,o){e(["./c_checkout_components_portable_checkout_frame"],t,o)})).then((function(e){return e.portable_checkout_frame_esnext})))}),[B,P]),B||P)return null;const ee=()=>{_.logSelectOverquotaRestrictionsModal("view_plans",Z),R?(E(!0),a.openDoormanUpsellModal({modalVersion:"glide-upsell-modal-dp-only",trialCardsLocation:a.TrialCardsLocation.OVERQUOTA_RESTRICTIONS_MODAL,reloadPageAfterPurchase:!0,onClose:()=>{F?n():s()},onDisplayed:()=>{a.unmountModal(void 0,J),E(!1)}})):(s(),a.redirect("/out-of-space?_tk=oq_restrictions_modal"),a.unmountModal(void 0,J))},te=()=>{_.logSelectOverquotaRestrictionsModal("manage_files",Z),a.redirect("/home?_tk=oq_restrictions_modal&pathway=download_and_delete_tooltip_tour&sort_by_size_desc=true"),s(),a.unmountModal(void 0,J)};let oe;u&&(oe=()=>{_.logSelectOverquotaRestrictionsModal("download_file",Z),null==u||u()});if(U===i.ViewMode.Preview&&!F&&!G&&!V)return D.default.createElement(l.Provider,{value:l.intl},D.default.createElement(r.OverQuotaFileViewerModal,{open:!0,onClose:()=>{n(),a.unmountModal(void 0,J)},headerText:i.PREVIEW_TITLE(d||""),bodyText:i.OVER_QUOTA_DELETION_WARNING(a.format_bytes(l.intl,A),a.format_bytes(l.intl,W)),badgeText:i.WARNING_BADGE,ctaText:i.VIEW_PLANS,onCtaClick:ee,filePreview:c,secondaryCtaText:i.MANAGE_FILES,secondaryCtaOnClick:te,tertiaryCtaText:i.DOWNLOAD_FILE,tertiaryCtaOnClick:oe,showCloseButton:!1,isPrimaryCtaLoading:M}));const ae=i.getAutoLayoutModalProps({viewMode:U,isMobileView:V,fileName:d,quotaUpsellInfo:O,warningMode:F,usedLessThanPlusQuota:G,filePreview:c,planContent:q,quotaUsedBytes:A,quotaAllocatedBytes:W,shouldUseSmallSkus:x,onViewPlansClick:ee,onCloseClick:e=>{e.preventDefault(),e.stopPropagation(),_.logSelectOverquotaRestrictionsModal("close_button",Z),F?n():s(),a.unmountModal(void 0,J)},onDownloadFileClick:oe,onManageFilesClick:te,onGetPlanClick:()=>{_.logSelectOverquotaRestrictionsModal("get_plan",Z),i.openPortableCheckoutModal({isOpen:!0,productPlanType:x?a.ProductPlanType.BASIC_PLUS:a.ProductPlanType.PLUS,onCloseClick:()=>{F?n():s(),a.unmountModal(void 0,i.PORTABLE_CHECKOUT_MODAL_ID)},onIframeLoadSuccess:()=>{_.logShownPortableCheckoutModalSuccess(),a.unmountModal(void 0,J)},onIframeLoadError:()=>{s(),_.logShownPortableCheckoutModalError(),a.unmountModal(void 0,J),x?a.redirect("/buy/dbx500?_tk=oq_restrictions_modal"):a.redirect("/buy/plus?_tk=oq_restrictions_modal")},onPurchaseSuccess:()=>{s(),_.logSelectPortableCheckoutModalPurchaseSuccess(),a.reload()}})}});return D.default.createElement(l.Provider,{value:l.intl},D.default.createElement($,{...ae,isPrimaryCtaLoading:M}))};X.displayName="FunctionalOverQuotaRestrictionsModal";t.openOverQuotaRestrictionsModal=e=>{a.mountModal(D.default.createElement(n.QueryClientProvider,{client:n.queryClient},D.default.createElement(X,{action:e.action,continueCallback:e.continueCallback,abortCallback:e.abortCallback,filePreview:e.filePreview,fileName:e.fileName,downloadFileHandler:e.downloadFileHandler})),void 0,J)}}));
//# sourceMappingURL=c_over-quota_over-quota-sweep-blocking-modal_open_over_quota_restrictions_modal.js-vfl1dHSoa.map

//# debugId=86501452-1efe-3938-8d79-7035e04378e0